{"ast":null,"code":"import Header from\"./Header\";import Footer from\"./Footer\";import Story from\"./Story\";import Form from\"./Form\";import{useState,useEffect,useRef}from\"react\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function App(){const[character1,setCharacter1]=useState(\"\");const[character2,setCharacter2]=useState(\"\");const[writer,setWriter]=useState(\"\");const[input,setInput]=useState(\"\");const[reply,setReply]=useState(\"\");const[loading,setLoading]=useState(false);const apiKey=process.env.OPEN_API_KEY;useEffect(()=>{const handleSend=async()=>{setLoading(true);try{var _data$choices,_data$choices$,_data$choices$$messag;const response=await fetch(\"https://api.openai.com/v1/chat/completions\",{method:\"POST\",headers:{\"Content-Type\":\"application/json\",Authorization:apiKey// ⚠️ Use env vars in production\n},body:JSON.stringify({model:\"gpt-3.5-turbo\",messages:[{role:\"user\",content:input}]})});const data=await response.json();const message=((_data$choices=data.choices)===null||_data$choices===void 0?void 0:(_data$choices$=_data$choices[0])===null||_data$choices$===void 0?void 0:(_data$choices$$messag=_data$choices$.message)===null||_data$choices$$messag===void 0?void 0:_data$choices$$messag.content)||\"[No response]\";setReply(message);}catch(error){setReply(\"Error: \"+error.message);}finally{setLoading(false);}};if(input)handleSend();return()=>{};},[input]);// 👈 Dependency array\nreturn/*#__PURE__*/_jsxs(\"div\",{className:\"App\",children:[/*#__PURE__*/_jsx(Header,{title:\"AI generated storyline\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"container\",children:[/*#__PURE__*/_jsx(Form,{character1:character1,character2:character2,writer:writer,loading:loading,setCharacter1:setCharacter1,setCharacter2:setCharacter2,setWriter:setWriter,setInput:setInput}),/*#__PURE__*/_jsx(Story,{story:reply}),\";\"]}),/*#__PURE__*/_jsx(Footer,{})]});}export default App;","map":{"version":3,"names":["Header","Footer","Story","Form","useState","useEffect","useRef","jsx","_jsx","jsxs","_jsxs","App","character1","setCharacter1","character2","setCharacter2","writer","setWriter","input","setInput","reply","setReply","loading","setLoading","apiKey","process","env","OPEN_API_KEY","handleSend","_data$choices","_data$choices$","_data$choices$$messag","response","fetch","method","headers","Authorization","body","JSON","stringify","model","messages","role","content","data","json","message","choices","error","className","children","title","story"],"sources":["/home/ec2-user/aibook/frontend/src/App.js"],"sourcesContent":["import Header from \"./Header\";\nimport Footer from \"./Footer\";\nimport Story from \"./Story\";\nimport Form from \"./Form\";\nimport { useState, useEffect, useRef } from \"react\";\n\nfunction App() {\n  const [character1, setCharacter1] = useState(\"\");\n  const [character2, setCharacter2] = useState(\"\");\n  const [writer, setWriter] = useState(\"\");\n  const [input, setInput] = useState(\"\");\n  const [reply, setReply] = useState(\"\");\n  const [loading, setLoading] = useState(false);\n  const apiKey = process.env.OPEN_API_KEY;\n\n\n  useEffect(() => {\n    const handleSend = async () => {\n      setLoading(true);\n      try {\n        const response = await fetch(\n          \"https://api.openai.com/v1/chat/completions\",\n          {\n            method: \"POST\",\n            headers: {\n              \"Content-Type\": \"application/json\",\n              Authorization: apiKey, // ⚠️ Use env vars in production\n            },\n            body: JSON.stringify({\n              model: \"gpt-3.5-turbo\",\n              messages: [{ role: \"user\", content: input }],\n            }),\n          },\n        );\n\n        const data = await response.json();\n        const message = data.choices?.[0]?.message?.content || \"[No response]\";\n        setReply(message);\n      } catch (error) {\n        setReply(\"Error: \" + error.message);\n      } finally {\n        setLoading(false);\n      }\n    };\n\n    if (input) handleSend();\n    return () => {};\n  }, [input]); // 👈 Dependency array\n\n  return (\n    <div className=\"App\">\n      <Header title={\"AI generated storyline\"} />\n      <div className=\"container\">\n        <Form\n          character1={character1}\n          character2={character2}\n          writer={writer}\n          loading={loading}\n          setCharacter1={setCharacter1}\n          setCharacter2={setCharacter2}\n          setWriter={setWriter}\n          setInput={setInput}\n        />\n        <Story story={reply} />;\n      </div>\n      <Footer />\n    </div>\n  );\n}\n\nexport default App;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}